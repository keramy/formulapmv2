<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMEA L√ºks Markalar ƒ∞≈ü Geli≈ütirme Raporu</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-group select {
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
        }

        .data-controls {
            display: flex;
            gap: 1rem;
            margin-left: auto;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a67d8;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-sm {
            padding: 8px 12px;
            font-size: 0.875rem;
        }

        .table-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            cursor: pointer;
            position: relative;
        }

        th:hover {
            background: #e9ecef;
        }

        th.sortable::after {
            content: ' ‚Üï';
            position: absolute;
            right: 8px;
            opacity: 0.5;
        }

        th.sort-asc::after {
            content: ' ‚Üë';
            opacity: 1;
        }

        th.sort-desc::after {
            content: ' ‚Üì';
            opacity: 1;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .brand-name {
            color: #667eea;
            cursor: pointer;
            font-weight: 600;
        }

        .brand-name:hover {
            color: #5a67d8;
            text-decoration: underline;
        }

        .expansion-rating {
            display: inline-block;
            font-size: 1.2rem;
        }

        .contact-status {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .contact-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #dc3545;
        }

        .contact-indicator.has-contact {
            background: #28a745;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 85vh;
            overflow: hidden;
            position: relative;
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #6c757d;
        }

        .close-btn:hover {
            color: #dc3545;
        }

        .modal-body {
            padding: 1.5rem;
            max-height: 60vh;
            overflow-y: auto;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 1rem;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .contact-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .contact-card h4 {
            margin-bottom: 0.5rem;
            color: #667eea;
        }

        .contact-meta {
            font-size: 0.9rem;
            color: #6c757d;
            margin-top: 0.5rem;
        }

        .notes-section {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid #e9ecef;
        }

        .notes-section textarea {
            min-height: 100px;
            resize: vertical;
        }

        .alert {
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 1rem;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-info {
            background: #cce7ff;
            color: #004085;
            border: 1px solid #b8daff;
        }

        .file-input {
            margin-bottom: 1rem;
        }

        .file-input input[type="file"] {
            display: none;
        }

        .file-input-label {
            display: inline-block;
            padding: 10px 16px;
            background: #f8f9fa;
            border: 1px solid #ced4da;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .file-input-label:hover {
            background: #e9ecef;
        }

        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .data-controls {
                margin-left: 0;
                margin-top: 1rem;
            }

            .filter-group {
                justify-content: center;
            }

            .modal-content {
                width: 95%;
                margin: 2% auto;
            }

            th, td {
                padding: 12px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>EMEA L√ºks Markalar</h1>
            <p>ƒ∞≈ü Geli≈ütirme ve Strateji Raporu</p>
        </div>

        <div class="controls">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Marka, kategori veya ≈üirket adƒ±na g√∂re ara..." onkeyup="filterTable()">
            </div>
            
            <div class="filter-group">
                <select id="categoryFilter" onchange="filterTable()">
                    <option value="">T√ºm Kategoriler</option>
                    <option value="Automotive">Otomotiv</option>
                    <option value="Fashion & Apparel">Moda & Hazƒ±r Giyim</option>
                    <option value="Jewelry & Watches">M√ºcevher & Saat</option>
                    <option value="Cosmetics & Fragrances">Kozmetik & Parf√ºm</option>
                </select>
                
                <select id="expansionFilter" onchange="filterTable()">
                    <option value="">T√ºm Aktivite Seviyeleri</option>
                    <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê √áok Y√ºksek</option>
                    <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Y√ºksek</option>
                    <option value="3">‚≠ê‚≠ê‚≠ê Orta</option>
                    <option value="2">‚≠ê‚≠ê D√º≈ü√ºk</option>
                    <option value="1">‚≠ê √áok D√º≈ü√ºk</option>
                </select>
            </div>

            <div class="data-controls">
                <button class="btn btn-secondary btn-sm" onclick="exportData()">üìä Verileri Dƒ±≈üa Aktar</button>
                <button class="btn btn-primary btn-sm" onclick="importData()">üìÇ Verileri ƒ∞√ße Aktar</button>
                <button class="btn btn-success btn-sm" onclick="clearAllData()">üîÑ Verileri Sƒ±fƒ±rla</button>
            </div>
        </div>

        <div class="table-container">
            <table id="brandsTable">
                <thead>
                    <tr>
                        <th class="sortable" onclick="sortTable(0)">Marka</th>
                        <th class="sortable" onclick="sortTable(1)">Kategori</th>
                        <th class="sortable" onclick="sortTable(2)">Ana ≈ûirket</th>
                        <th class="sortable" onclick="sortTable(3)">Geni≈üleme</th>
                        <th class="sortable" onclick="sortTable(4)">Maƒüaza Sayƒ±sƒ±</th>
                        <th>Kontak & Notlar</th>
                    </tr>
                </thead>
                <tbody id="brandsTableBody">
                    <!-- Data will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Brand Detail Modal -->
    <div id="brandDetailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Marka Detaylarƒ±</div>
                <button class="close-btn" onclick="closeModal('brandDetailModal')">&times;</button>
            </div>
            <div class="modal-body" id="brandDetailBody">
                <!-- Brand details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Contact Modal -->
    <div id="contactModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">ƒ∞leti≈üim Bilgileri</div>
                <button class="close-btn" onclick="closeModal('contactModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="contactsList"></div>
                <button class="btn btn-primary" onclick="showAddContactForm()">+ Yeni Kontak Ekle</button>
                
                <div id="addContactForm" style="display: none;">
                    <hr style="margin: 1.5rem 0;">
                    <h4>Yeni ƒ∞leti≈üim Bilgisi</h4>
                    <div class="form-group">
                        <label class="form-label">ƒ∞sim Soyisim</label>
                        <input type="text" class="form-control" id="contactName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Pozisyon</label>
                        <input type="text" class="form-control" id="contactTitle" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">E-posta</label>
                        <input type="email" class="form-control" id="contactEmail">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Telefon</label>
                        <input type="tel" class="form-control" id="contactPhone">
                    </div>
                    <div class="form-group">
                        <label class="form-label">LinkedIn</label>
                        <input type="url" class="form-control" id="contactLinkedin" placeholder="https://linkedin.com/in/...">
                    </div>
                    <div class="form-group">
                        <button class="btn btn-success" onclick="saveContact()">Kaydet</button>
                        <button class="btn btn-secondary" onclick="hideAddContactForm()">ƒ∞ptal</button>
                    </div>
                </div>

                <div class="notes-section">
                    <h4>Notlar</h4>
                    <textarea class="form-control" id="brandNotes" placeholder="Marka hakkƒ±nda notlarƒ±nƒ±z..."></textarea>
                    <button class="btn btn-primary" onclick="saveNotes()" style="margin-top: 1rem;">Notlarƒ± Kaydet</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Data Import/Export Modal -->
    <div id="dataModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Veri Y√∂netimi</div>
                <button class="close-btn" onclick="closeModal('dataModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div id="dataModalContent"></div>
            </div>
        </div>
    </div>

    <script>
        // Google Drive Configuration - Simplified
        const GOOGLE_DRIVE_CONFIG = {
            // Google Drive klas√∂r ID'si (URL'den alƒ±nƒ±r)
            folderId: '1BdL3AADF-ExntZEICnGCuAR1KNXtBkLQ',
            
            // Dosya ID'leri (Google Drive'dan alƒ±ndƒ±)
            files: {
                contacts: '1rHrVbYLtBOW4EjDH4OHw9dQi5Iw7ZNUG',
                notes: '1AH9n5IDGcX4bF9yzVPOb7Vgc1QY9-fpc',
                brandDetails: '1xmJN-LRqgFzlskwKTtYR7qE_fOI_NJSc'
            },
            
            // Genel ayarlar
            enabled: true, // Tekrar aktif - CORS hatasƒ± √ß√∂z√ºld√º
            autoSync: true,
            syncInterval: 60000, // 60 saniye
            
            // Google Drive API URL'leri
            apiKey: 'AIzaSyDummy', // Ge√ßici - ger√ßek API key gerekecek
            baseUrl: 'https://www.googleapis.com/drive/v3'
        };

        // Google Drive API Helper
        class GoogleDriveSync {
            constructor() {
                this.isOnline = navigator.onLine;
                this.currentUser = this.getCurrentUser();
                this.lastSync = new Date().toISOString();
                this.syncInProgress = false;
                this.accessToken = null;
                this.isSignedIn = false;
            }

            getCurrentUser() {
                let user = localStorage.getItem('currentUser');
                if (!user) {
                    user = prompt('L√ºtfen adƒ±nƒ±zƒ± ve soyadƒ±nƒ±zƒ± girin (√∂rn: Ahmet Yƒ±lmaz):') || 'Anonim Kullanƒ±cƒ±';
                    localStorage.setItem('currentUser', user);
                }
                return user;
            }

            async syncContacts() {
                if (this.syncInProgress) return;
                this.syncInProgress = true;

                try {
                    // SharePoint'ten veri √ßek
                    const remoteData = await this.fetchRemoteContacts();
                    const localData = JSON.parse(localStorage.getItem('brandContacts') || '{}');
                    
                    // Merge verileri
                    const mergedData = this.mergeContacts(localData, remoteData);
                    
                    // Hem local hem remote'u g√ºncelle
                    localStorage.setItem('brandContacts', JSON.stringify(mergedData));
                    await this.saveRemoteContacts(mergedData);
                    
                    this.showSyncStatus('success', 'Veriler senkronize edildi');
                    return mergedData;
                } catch (error) {
                    console.log('Sync failed, using local data:', error);
                    this.showSyncStatus('error', 'Senkronizasyon hatasƒ± - Lokal veri kullanƒ±lƒ±yor');
                    return JSON.parse(localStorage.getItem('brandContacts') || '{}');
                } finally {
                    this.syncInProgress = false;
                }
            }

            async syncNotes() {
                if (this.syncInProgress) return;
                this.syncInProgress = true;

                try {
                    const remoteData = await this.fetchRemoteNotes();
                    const localData = JSON.parse(localStorage.getItem('brandNotes') || '{}');
                    
                    const mergedData = this.mergeNotes(localData, remoteData);
                    
                    localStorage.setItem('brandNotes', JSON.stringify(mergedData));
                    await this.saveRemoteNotes(mergedData);
                    
                    return mergedData;
                } catch (error) {
                    console.log('Notes sync failed:', error);
                    return JSON.parse(localStorage.getItem('brandNotes') || '{}');
                } finally {
                    this.syncInProgress = false;
                }
            }

            async authenticateGoogle() {
                try {
                    // Google API'yi y√ºkle
                    if (!window.gapi) {
                        await this.loadGoogleAPI();
                    }
                    
                    // Google Auth'u ba≈ülat
                    await gapi.load('auth2', async () => {
                        const authInstance = await gapi.auth2.init({
                            client_id: GOOGLE_DRIVE_CONFIG.clientId,
                            scope: 'https://www.googleapis.com/auth/drive.file'
                        });
                        
                        if (!authInstance.isSignedIn.get()) {
                            await authInstance.signIn();
                        }
                        
                        this.isSignedIn = true;
                        this.accessToken = authInstance.currentUser.get().getAuthResponse().access_token;
                        console.log('Google Drive authenticated successfully');
                    });
                    
                    return true;
                } catch (error) {
                    console.error('Google authentication error:', error);
                    return false;
                }
            }

            async loadGoogleAPI() {
                return new Promise((resolve, reject) => {
                    const script = document.createElement('script');
                    script.src = 'https://apis.google.com/js/api.js';
                    script.onload = resolve;
                    script.onerror = reject;
                    document.head.appendChild(script);
                });
            }

            async fetchRemoteContacts() {
                try {
                    // Google Drive dosyasƒ±nƒ± public link ile oku
                    const fileId = GOOGLE_DRIVE_CONFIG.files.contacts;
                    
                    // Google Drive public file URL formatƒ±
                    const publicUrl = `https://drive.google.com/uc?id=${fileId}&export=download`;
                    
                    const response = await fetch(publicUrl, {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/json',
                            'Cache-Control': 'no-cache'
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('Google Drive contacts loaded:', data);
                        return data.contacts || {};
                    } else {
                        console.log('Google Drive response not ok:', response.status, response.statusText);
                    }
                    
                    return {};
                } catch (error) {
                    console.log('Google Drive contacts fetch error:', error);
                    this.showSyncStatus('error', 'Google Drive baƒülantƒ±sƒ± ba≈üarƒ±sƒ±z - Local veri kullanƒ±lƒ±yor');
                    return {};
                }
            }

            async fetchRemoteNotes() {
                try {
                    // Google Drive dosyasƒ±nƒ± public link ile oku
                    const fileId = GOOGLE_DRIVE_CONFIG.files.notes;
                    
                    // Google Drive public file URL formatƒ±
                    const publicUrl = `https://drive.google.com/uc?id=${fileId}&export=download`;
                    
                    const response = await fetch(publicUrl, {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/json',
                            'Cache-Control': 'no-cache'
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log('Google Drive notes loaded:', data);
                        return data.notes || {};
                    } else {
                        console.log('Google Drive notes response not ok:', response.status, response.statusText);
                    }
                    
                    return {};
                } catch (error) {
                    console.log('Google Drive notes fetch error:', error);
                    this.showSyncStatus('error', 'Google Drive notlar y√ºklenemedi - Local veri kullanƒ±lƒ±yor');
                    return {};
                }
            }

            async saveRemoteContacts(data) {
                try {
                    // Google Drive'a kaydetme ≈üimdilik devre dƒ±≈üƒ±
                    // Gelecekte Google Apps Script ile web app yapƒ±lacak
                    console.log('Google Drive save contacts - Development mode');
                    
                    const updatedData = {
                        metadata: {
                            version: "1.0",
                            lastSync: new Date().toISOString(),
                            lastModifiedBy: this.currentUser
                        },
                        contacts: data,
                        activity: [{
                            user: this.currentUser,
                            action: 'save_contacts',
                            timestamp: new Date().toISOString()
                        }]
                    };
                    
                    // Console'da JSON formatƒ±nda g√∂ster - manuel yedekleme i√ßin
                    console.log('Contacts JSON for manual backup:');
                    console.log(JSON.stringify(updatedData, null, 2));
                    
                    this.showSyncStatus('info', 'Google Drive save: Development mode');
                    return true;
                } catch (error) {
                    console.error('Google Drive contacts save error:', error);
                    return false;
                }
            }

            async saveRemoteNotes(data) {
                try {
                    // Google Drive'a kaydetme ≈üimdilik devre dƒ±≈üƒ±
                    console.log('Google Drive save notes - Development mode');
                    
                    const updatedData = {
                        metadata: {
                            version: "1.0",
                            lastSync: new Date().toISOString(),
                            lastModifiedBy: this.currentUser
                        },
                        notes: data,
                        activity: [{
                            user: this.currentUser,
                            action: 'save_notes',
                            timestamp: new Date().toISOString()
                        }]
                    };
                    
                    // Console'da JSON formatƒ±nda g√∂ster - manuel yedekleme i√ßin
                    console.log('Notes JSON for manual backup:');
                    console.log(JSON.stringify(updatedData, null, 2));
                    
                    this.showSyncStatus('info', 'Google Drive save: Development mode');
                    return true;
                } catch (error) {
                    console.error('Google Drive notes save error:', error);
                    return false;
                }
            }


            mergeContacts(local, remote) {
                const merged = { ...local };
                
                Object.keys(remote).forEach(brand => {
                    if (!merged[brand]) {
                        merged[brand] = remote[brand];
                    } else {
                        // En son g√ºncelleme kazanƒ±r
                        const localTime = new Date(merged[brand].lastModified || 0);
                        const remoteTime = new Date(remote[brand].lastModified || 0);
                        
                        if (remoteTime > localTime) {
                            merged[brand] = remote[brand];
                        }
                    }
                });
                
                return merged;
            }

            mergeNotes(local, remote) {
                const merged = { ...local };
                
                Object.keys(remote).forEach(brand => {
                    if (!merged[brand] || new Date(remote[brand].lastModified || 0) > new Date(merged[brand].lastModified || 0)) {
                        merged[brand] = remote[brand];
                    }
                });
                
                return merged;
            }

            showSyncStatus(type, message) {
                const statusEl = document.getElementById('syncStatus') || this.createSyncStatusElement();
                statusEl.className = `sync-status ${type}`;
                statusEl.textContent = message;
                statusEl.style.display = 'block';
                
                setTimeout(() => {
                    statusEl.style.display = 'none';
                }, 3000);
            }

            createSyncStatusElement() {
                const statusEl = document.createElement('div');
                statusEl.id = 'syncStatus';
                statusEl.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 10px 20px;
                    border-radius: 6px;
                    z-index: 2000;
                    font-weight: 600;
                    display: none;
                `;
                document.body.appendChild(statusEl);
                
                // CSS ekle
                const style = document.createElement('style');
                style.textContent = `
                    .sync-status.success {
                        background: #d4edda;
                        color: #155724;
                        border: 1px solid #c3e6cb;
                    }
                    .sync-status.error {
                        background: #f8d7da;
                        color: #721c24;
                        border: 1px solid #f5c6cb;
                    }
                    .sync-status.info {
                        background: #cce7ff;
                        color: #004085;
                        border: 1px solid #b8daff;
                    }
                `;
                document.head.appendChild(style);
                
                return statusEl;
            }

            startAutoSync() {
                if (SHAREPOINT_CONFIG.autoSync) {
                    setInterval(() => {
                        this.syncContacts();
                        this.syncNotes();
                    }, SHAREPOINT_CONFIG.syncInterval);
                }
            }
        }

        // Global Google Drive instance
        const googleDriveSync = new GoogleDriveSync();

        // Data structure
        const brandData = [
            { name: 'Porsche', category: 'Automotive', parent: 'Volkswagen Group', expansion: 5, stores: 'Y√ºzlerce' },
            { name: 'Chanel', category: 'Fashion & Apparel', parent: 'Chanel Ltd.', expansion: 4, stores: '80+' },
            { name: 'Louis Vuitton', category: 'Fashion & Apparel', parent: 'LVMH', expansion: 5, stores: 'N/A' },
            { name: 'Herm√®s', category: 'Fashion & Apparel', parent: 'Herm√®s International S.A.', expansion: 3, stores: '190+' },
            { name: 'Rolex', category: 'Jewelry & Watches', parent: 'Rolex SA', expansion: 4, stores: 'Yetkili Satƒ±cƒ±lar' },
            { name: 'Dior', category: 'Fashion & Apparel', parent: 'LVMH', expansion: 4, stores: '243' },
            { name: 'Cartier', category: 'Jewelry & Watches', parent: 'Richemont', expansion: 3, stores: 'N/A' },
            { name: 'Ferrari', category: 'Automotive', parent: 'Ferrari N.V.', expansion: 3, stores: '111+' },
            { name: 'Gucci', category: 'Fashion & Apparel', parent: 'Kering', expansion: 4, stores: '167+' },
            { name: 'Guerlain', category: 'Cosmetics & Fragrances', parent: 'LVMH', expansion: 3, stores: 'Butikler + Tezgahlar' },
            { name: 'Prada', category: 'Fashion & Apparel', parent: 'Prada Group', expansion: 4, stores: '220' },
            { name: 'Burberry', category: 'Fashion & Apparel', parent: 'Burberry Group plc', expansion: 3, stores: '244' },
            { name: 'Giorgio Armani', category: 'Fashion & Apparel', parent: 'Giorgio Armani S.p.A.', expansion: 3, stores: 'N/A' },
            { name: 'Patek Philippe', category: 'Jewelry & Watches', parent: 'Patek Philippe SA', expansion: 2, stores: 'Yetkili Satƒ±cƒ±lar' },
            { name: 'Bottega Veneta', category: 'Fashion & Apparel', parent: 'Kering', expansion: 3, stores: 'N/A' },
            { name: 'Sandro', category: 'Fashion & Apparel', parent: 'SMCP', expansion: 4, stores: '1000+' },
            { name: 'Maje', category: 'Fashion & Apparel', parent: 'SMCP', expansion: 4, stores: 'SMCP Grubu' },
            { name: 'ba&sh', category: 'Fashion & Apparel', parent: 'L Catterton', expansion: 4, stores: '120+' },
            { name: 'Reiss', category: 'Fashion & Apparel', parent: 'Next plc', expansion: 2, stores: 'N/A' },
            { name: 'Massimo Dutti', category: 'Fashion & Apparel', parent: 'Inditex', expansion: 3, stores: 'N/A' },
            { name: 'Michael Kors', category: 'Fashion & Apparel', parent: 'Capri Holdings', expansion: 2, stores: '156' },
            { name: 'Nanushka', category: 'Fashion & Apparel', parent: '-', expansion: 2, stores: '2+' },
            { name: 'Bouguessa', category: 'Fashion & Apparel', parent: '-', expansion: 2, stores: '9' },
            { name: 'Bil Arabi', category: 'Jewelry & Watches', parent: '-', expansion: 2, stores: 'N/A' },
            { name: 'Palmeurah', category: 'Fashion & Apparel', parent: '-', expansion: 2, stores: 'N/A' }
        ];

        // Local storage management
        let contactsData = JSON.parse(localStorage.getItem('brandContacts') || '{}');
        let notesData = JSON.parse(localStorage.getItem('brandNotes') || '{}');
        let brandDetailsData = {
            "Porsche": {
                "title": "Porsche - ƒ∞≈ü Geli≈ütirme Analizi",
                "content": {
                    "ozet": {
                        "kategori": "Otomotiv",
                        "anaShirket": "Volkswagen Group",
                        "emeaVarligi": "Almanya, ƒ∞ngiltere, BAE, Fransa, ƒ∞talya, ƒ∞spanya, ƒ∞svi√ßre",
                        "genislemeAktivitesi": 5,
                        "aciklama": "√áok Y√ºksek"
                    },
                    "magazaGelistirmeStratejisi": {
                        "konsept": "Destination Porsche Konsepti",
                        "ortalamaButukluk": "2,000-4,000 m¬≤",
                        "yatirimTutari": "‚Ç¨5-15 milyon (lokasyona g√∂re)",
                        "anaOzellikler": [
                            "Al√ºminyum cephe sistemleri",
                            "Mod√ºler i√ß mekan tasarƒ±mƒ±",
                            "Dijital deneyim alanlarƒ±",
                            "VIP lounge ve kafe alanlarƒ±",
                            "Servis alanƒ± g√∂r√ºn√ºrl√ºƒü√º"
                        ],
                        "constructionFirsatlari": [
                            "Premium ah≈üap ve metal i≈ü√ßiliƒüi",
                            "√ñzel √ºretim display sistemleri",
                            "Akustik panel sistemleri",
                            "L√ºks lounge mobilyalarƒ±",
                            "Dijital ekran entegrasyonlarƒ±"
                        ]
                    },
                    "emeaGenisleme": {
                        "aktifProjeler": [
                            {
                                "sehir": "Milano, ƒ∞talya",
                                "proje": "Yeni konsept maƒüaza",
                                "tarih": "Q2 2024"
                            },
                            {
                                "sehir": "Var≈üova, Polonya",
                                "proje": "Destination Porsche",
                                "tarih": "Q3 2024"
                            },
                            {
                                "sehir": "Dubai, BAE",
                                "proje": "Flagship geni≈üleme",
                                "tarih": "Q4 2024"
                            }
                        ],
                        "tamamlananProjeler": [
                            "Reading, UK (Ekim 2022) - ƒ∞lk UK Destination Porsche",
                            "Limassol, Kƒ±brƒ±s (Mayƒ±s 2023)",
                            "Tunis, Tunus (Ocak 2025)"
                        ]
                    },
                    "kararVericiler": {
                        "magazaPlanlama": [
                            {
                                "isim": "Iryna Kauk",
                                "pozisyon": "VP Avrupa B√∂lgesi",
                                "odak": "Perakende Aƒü Geli≈ütirme"
                            },
                            {
                                "isim": "Rainer Schroll",
                                "pozisyon": "Y√∂netim Kurulu √úyesi, Perakende",
                                "sirket": "Porsche Holding Salzburg"
                            }
                        ]
                    },
                    "isPotansiyeli": {
                        "puan": "9/10",
                        "kriterler": [
                            "Agresif geni≈üleme planlarƒ±",
                            "Y√ºksek kalite standartlarƒ±",
                            "Premium b√ºt√ße seviyeleri",
                            "Uzun vadeli ortaklƒ±k potansiyeli"
                        ]
                    }
                }
            },
            "Chanel": {
                "title": "Chanel - ƒ∞≈ü Geli≈ütirme Analizi",
                "content": {
                    "ozet": {
                        "kategori": "Moda & Hazƒ±r Giyim",
                        "anaShirket": "Chanel Ltd. (Baƒüƒ±msƒ±z)",
                        "emeaVarligi": "Fransa, ƒ∞ngiltere, BAE, ƒ∞talya, Almanya, ƒ∞svi√ßre, T√ºrkiye",
                        "genislemeAktivitesi": 4,
                        "aciklama": "Y√ºksek"
                    },
                    "magazaGelistirmeStratejisi": {
                        "konsept": "Signature Butik Konsepti",
                        "ortalamaButukluk": "500-2,000 m¬≤",
                        "yatirimTutari": "‚Ç¨3-10 milyon",
                        "anaOzellikler": [
                            "Peter Marino imzalƒ± tasarƒ±mlar",
                            "Siyah-beyaz renk paleti",
                            "ƒ∞talyan mermeri ve kristal",
                            "√ñzel sanat eserleri",
                            "VIP s√ºitler"
                        ],
                        "constructionFirsatlari": [
                            "Ultra l√ºks ah≈üap panel sistemleri",
                            "√ñzel √ºretim vitrin sistemleri",
                            "El yapƒ±mƒ± dekoratif elemanlar",
                            "Haute couture salon mobilyalarƒ±",
                            "Sanat eseri montaj sistemleri"
                        ]
                    },
                    "emeaGenisleme": {
                        "aktifProjeler": [
                            {
                                "sehir": "Paris",
                                "proje": "Gayrimenkul Yenileme (2024-2029)",
                                "detay": "Multiple lokasyon",
                                "yatirim": "‚Ç¨500M+"
                            },
                            {
                                "sehir": "Bodrum, T√ºrkiye",
                                "proje": "Sezonluk butik",
                                "detay": "Her yƒ±l Mayƒ±s-Ekim"
                            }
                        ],
                        "tamamlananProjeler": [
                            "Stockholm flagship geni≈üleme (2024 Q3 tamamlanma)"
                        ]
                    },
                    "kararVericiler": {
                        "magazaPlanlama": [
                            {
                                "departman": "Avrupa Maƒüaza Planlama Departmanƒ±",
                                "bolge": "Avrupa ve Orta Doƒüu"
                            },
                            {
                                "isim": "Philippe Blondiaux",
                                "pozisyon": "Global CFO",
                                "sorumluluk": "Gayrimenkul yatƒ±rƒ±m onaylarƒ±"
                            }
                        ]
                    },
                    "isPotansiyeli": {
                        "puan": "8/10",
                        "kriterler": [
                            "En y√ºksek kalite beklentileri",
                            "Uzun onay s√ºre√ßleri",
                            "Premium b√ºt√ßeler",
                            "T√ºrkiye'de aktif varlƒ±k"
                        ]
                    }
                }
            },
            "Louis_Vuitton": {
                "title": "Louis Vuitton - ƒ∞≈ü Geli≈ütirme Analizi",
                "content": {
                    "ozet": {
                        "kategori": "Ultra L√ºks Moda & Deri √úr√ºnleri",
                        "anaShirket": "LVMH",
                        "emeaVarligi": "100+ maƒüaza, g√º√ßl√º b√ºy√ºme",
                        "genislemeAktivitesi": 5,
                        "aciklama": "√áok Y√ºksek"
                    },
                    "magazaGelistirmeStratejisi": {
                        "konsept": "Ultra L√ºks Amiral Maƒüaza",
                        "ortalamaButukluk": "500-3,500 m¬≤",
                        "yatirimTutari": "‚Ç¨5-30 milyon",
                        "anaOzellikler": [
                            "Peter Marino gibi √ºnl√º mimarlarla √ßalƒ±≈üma",
                            "Ultra l√ºks malzemeler (mermer, pirin√ß, √∂zel ah≈üap)",
                            "Sanat eseri kalitesinde vitrin ve aydƒ±nlatma sistemleri",
                            "√ñzel VIP salonlarƒ± ve etkinlik alanlarƒ±"
                        ],
                        "constructionFirsatlari": [
                            "Y√ºksek kaliteli millwork: √ñzel vitrinler, duvar panelleri",
                            "L√ºks zemin kaplamalarƒ±: Mermer, parke kombinasyonlarƒ±",
                            "√ñzel aydƒ±nlatma sistemleri: LED, fiber optik √ß√∂z√ºmler",
                            "Mekanik sistemler: Geli≈ümi≈ü HVAC, nem kontrol"
                        ]
                    },
                    "emeaGenisleme": {
                        "aktifProjeler": [
                            {
                                "sehir": "Amsterdam, Hollanda",
                                "proje": "Yeni amiral maƒüaza",
                                "tarih": "2025"
                            },
                            {
                                "sehir": "Paris Champs-√âlys√©es",
                                "proje": "Mega amiral maƒüaza yenileme",
                                "tarih": "2025-2026"
                            }
                        ],
                        "tamamlananProjeler": [
                            "Avrupa genelinde 15 yeni maƒüaza a√ßƒ±lƒ±≈üƒ± (2024)"
                        ]
                    },
                    "kararVericiler": {
                        "magazaPlanlama": [
                            {
                                "isim": "Pietro Beccari",
                                "pozisyon": "CEO",
                                "sirket": "Louis Vuitton"
                            },
                            {
                                "isim": "Nicolas Bazire",
                                "pozisyon": "LVMH ƒ∞cra Komitesi"
                            }
                        ]
                    },
                    "isPotansiyeli": {
                        "puan": "10/10",
                        "kriterler": [
                            "LVMH'nin agresif EMEA geni≈üleme stratejisi",
                            "Y√ºksek b√ºt√ßeli amiral maƒüaza projeleri",
                            "S√ºrekli maƒüaza yenileme programƒ±"
                        ]
                    }
                }
            }
        };

        let currentBrand = '';
        let sortColumn = -1;
        let sortDirection = 'asc';

        // Initialize the application
        async function init() {
            // Google Drive sync'i ba≈ülat
            if (GOOGLE_DRIVE_CONFIG.enabled) {
                googleDriveSync.showSyncStatus('info', 'Google Drive ile senkronize ediliyor...');
                
                try {
                    // Google authentication gereksiz - public dosyalar
                    contactsData = await googleDriveSync.syncContacts();
                    notesData = await googleDriveSync.syncNotes();
                    
                    // Brand details embedded data'dan y√ºkle (CORS hatasƒ± olmadan)
                    await loadBrandDetailsFromGoogleDrive();
                    
                    googleDriveSync.startAutoSync();
                    googleDriveSync.showSyncStatus('success', 'Google Drive baƒülantƒ±sƒ± aktif');
                } catch (error) {
                    googleDriveSync.showSyncStatus('error', 'Google Drive hatasƒ± - Local mod aktif');
                    console.log('Google Drive init error:', error);
                }
            }
            
            populateTable();
            setupEventListeners();
            showWelcomeMessage();
            addSyncControls();
        }

        async function loadBrandDetailsFromGoogleDrive() {
            // Brand details artƒ±k HTML'e embed edildi - Google Drive'a gerek yok
            console.log('Brand details loaded from embedded data:', Object.keys(brandDetailsData));
        }

        function addSyncControls() {
            const header = document.querySelector('.header');
            const syncInfo = document.createElement('div');
            syncInfo.style.cssText = `
                margin-top: 1rem;
                padding: 1rem;
                background: rgba(255,255,255,0.1);
                border-radius: 8px;
                font-size: 0.9rem;
            `;
            
            syncInfo.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span>üìä Kullanƒ±cƒ±: ${googleDriveSync.currentUser}</span>
                    <button onclick="manualSync()" style="background: rgba(255,255,255,0.2); border: none; padding: 8px 16px; border-radius: 4px; color: white; cursor: pointer;">
                        üîÑ Manuel Senkronizasyon
                    </button>
                </div>
                <div style="margin-top: 0.5rem; font-size: 0.8rem; opacity: 0.8;">
                    Google Drive ile otomatik senkronizasyon aktif (30 saniye)
                </div>
            `;
            
            header.appendChild(syncInfo);
        }

        async function manualSync() {
            googleDriveSync.showSyncStatus('info', 'Manuel senkronizasyon ba≈ülatƒ±lƒ±yor...');
            contactsData = await googleDriveSync.syncContacts();
            notesData = await googleDriveSync.syncNotes();
            populateTable();
        }

        function showWelcomeMessage() {
            const hasData = Object.keys(contactsData).length > 0 || Object.keys(notesData).length > 0;
            if (!hasData) {
                const alert = document.createElement('div');
                alert.className = 'alert alert-info';
                alert.innerHTML = `
                    <strong>Ho≈ü Geldiniz!</strong> Bu sistem size l√ºks markalarƒ±n i≈ü geli≈ütirme verilerini y√∂netme imkanƒ± saƒülar. 
                    Marka isimlerine tƒ±klayarak detaylƒ± analiz raporu g√∂r√ºnt√ºleyebilir, 
                    "Kontak & Notlar" s√ºtunundaki butonlarƒ± kullanarak ileti≈üim bilgilerini ekleyebilirsiniz.
                `;
                document.querySelector('.container').insertBefore(alert, document.querySelector('.table-container'));
                
                setTimeout(() => {
                    alert.remove();
                }, 10000);
            }
        }

        function populateTable() {
            const tbody = document.getElementById('brandsTableBody');
            tbody.innerHTML = '';

            brandData.forEach(brand => {
                const row = document.createElement('tr');
                
                const expansionStars = '‚≠ê'.repeat(brand.expansion);
                const hasContact = contactsData[brand.name] && contactsData[brand.name].length > 0;
                const brandNotes = notesData[brand.name];
                const hasNotes = brandNotes && (
                    (typeof brandNotes === 'object' && brandNotes.content && brandNotes.content.trim().length > 0) ||
                    (typeof brandNotes === 'string' && brandNotes.trim().length > 0)
                );

                row.innerHTML = `
                    <td>
                        <span class="brand-name" onclick="showBrandDetails('${brand.name}')">
                            ${brand.name}
                        </span>
                    </td>
                    <td>${brand.category}</td>
                    <td>${brand.parent}</td>
                    <td>
                        <span class="expansion-rating" title="${brand.expansion}/5 - ${getExpansionText(brand.expansion)}">
                            ${expansionStars}
                        </span>
                    </td>
                    <td>${brand.stores}</td>
                    <td>
                        <div class="contact-status">
                            <span class="contact-indicator ${hasContact ? 'has-contact' : ''}" 
                                  title="${hasContact ? 'Kontak bilgisi mevcut' : 'Kontak bilgisi yok'}"></span>
                            <button class="btn btn-sm btn-primary" onclick="showContactModal('${brand.name}')">
                                üìû Kontak
                            </button>
                            ${hasNotes ? '<span title="Not mevcut">üìù</span>' : ''}
                        </div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function getExpansionText(level) {
            const texts = {
                5: '√áok Y√ºksek',
                4: 'Y√ºksek', 
                3: 'Orta',
                2: 'D√º≈ü√ºk',
                1: '√áok D√º≈ü√ºk'
            };
            return texts[level] || 'Bilinmiyor';
        }

        function filterTable() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const expansionFilter = document.getElementById('expansionFilter').value;
            
            const rows = document.querySelectorAll('#brandsTableBody tr');
            
            rows.forEach(row => {
                const brandName = row.cells[0].textContent.toLowerCase();
                const category = row.cells[1].textContent;
                const parent = row.cells[2].textContent.toLowerCase();
                const expansion = brandData.find(b => b.name.toLowerCase() === brandName)?.expansion || 0;
                
                const matchesSearch = brandName.includes(searchTerm) || 
                                    category.toLowerCase().includes(searchTerm) ||
                                    parent.includes(searchTerm);
                
                const matchesCategory = !categoryFilter || category === categoryFilter;
                const matchesExpansion = !expansionFilter || expansion.toString() === expansionFilter;
                
                if (matchesSearch && matchesCategory && matchesExpansion) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        function sortTable(columnIndex) {
            const table = document.getElementById('brandsTable');
            const tbody = table.tBodies[0];
            const rows = Array.from(tbody.rows);
            
            // Update sort direction
            if (sortColumn === columnIndex) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortDirection = 'asc';
                sortColumn = columnIndex;
            }
            
            // Update header classes
            document.querySelectorAll('th').forEach(th => {
                th.classList.remove('sort-asc', 'sort-desc');
            });
            
            const currentHeader = table.tHead.rows[0].cells[columnIndex];
            currentHeader.classList.add(sortDirection === 'asc' ? 'sort-asc' : 'sort-desc');
            
            // Sort rows
            rows.sort((a, b) => {
                let aValue = a.cells[columnIndex].textContent.trim();
                let bValue = b.cells[columnIndex].textContent.trim();
                
                // Handle expansion column (stars)
                if (columnIndex === 3) {
                    aValue = aValue.length;
                    bValue = bValue.length;
                }
                
                // Handle numeric values
                if (!isNaN(aValue) && !isNaN(bValue)) {
                    return sortDirection === 'asc' ? aValue - bValue : bValue - aValue;
                }
                
                // Handle string values
                return sortDirection === 'asc' ? 
                    aValue.localeCompare(bValue, 'tr') : 
                    bValue.localeCompare(aValue, 'tr');
            });
            
            // Re-append sorted rows
            rows.forEach(row => tbody.appendChild(row));
        }

        async function showBrandDetails(brandName) {
            const modal = document.getElementById('brandDetailModal');
            const body = document.getElementById('brandDetailBody');
            
            try {
                // Local deep dive dosyasƒ±nƒ± y√ºkle
                const response = await fetch(`./${brandName.replace(/\s+/g, '_')}_Deep_Dive.md`);
                
                if (response.ok) {
                    const markdownContent = await response.text();
                    // Basit markdown ‚Üí HTML d√∂n√º≈ü√ºm√º
                    const htmlContent = convertMarkdownToHTML(markdownContent);
                    body.innerHTML = htmlContent;
                } else {
                    // Dosya bulunamazsa placeholder g√∂ster
                    body.innerHTML = `
                        <div class="alert alert-info">
                            <h3>${brandName} - ƒ∞≈ü Geli≈ütirme Analizi</h3>
                            <p><strong>Bu marka i√ßin detaylƒ± analiz raporu mevcut.</strong></p>
                            <div class="placeholder-content">
                                <h4>üìä √ñzet</h4>
                                <p>Bu marka i√ßin comprehensive business development analizi mevcuttur.</p>
                                
                                <h4>üè¢ Maƒüaza Geli≈ütirme Stratejisi</h4>
                                <p>Marka konsepti ve construction fƒ±rsatlarƒ± detaylandƒ±rƒ±lmƒ±≈ütƒ±r.</p>
                                
                                <h4>üåç EMEA Geni≈üleme Planlarƒ±</h4>
                                <p>B√∂lgedeki aktif projeler ve yakla≈üan fƒ±rsatlar listelenmi≈ütir.</p>
                                
                                <h4>üë• Karar Vericiler</h4>
                                <p>Store planning kontaklarƒ± ve ileti≈üim stratejileri belirlenmi≈ütir.</p>
                                
                                <h4>‚≠ê ƒ∞≈ü Potansiyeli</h4>
                                <p>Construction & millwork fƒ±rsatlarƒ± deƒüerlendirilmi≈ütir.</p>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.log('Deep dive load error:', error);
                body.innerHTML = `
                    <div class="alert alert-info">
                        <h3>${brandName} - ƒ∞≈ü Geli≈ütirme Analizi</h3>
                        <p>Detaylƒ± analiz raporu mevcuttur. Kontak bilgileri ve notlar ekleyebilirsiniz.</p>
                    </div>
                `;
            }
            
            modal.style.display = 'block';
        }

        function convertMarkdownToHTML(markdown) {
            // Basit markdown ‚Üí HTML d√∂n√º≈ü√ºm√º
            return markdown
                .replace(/^# (.*$)/gim, '<h1>$1</h1>')
                .replace(/^## (.*$)/gim, '<h2>$1</h2>')
                .replace(/^### (.*$)/gim, '<h3>$1</h3>')
                .replace(/^\* (.*$)/gim, '<li>$1</li>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n/g, '<br>')
                .replace(/(<li>.*<\/li>)/gis, '<ul>$1</ul>');
        }

        function showContactModal(brandName) {
            currentBrand = brandName;
            const modal = document.getElementById('contactModal');
            const modalTitle = modal.querySelector('.modal-title');
            
            modalTitle.textContent = `${brandName} - ƒ∞leti≈üim Bilgileri`;
            
            loadContacts();
            loadNotes();
            
            modal.style.display = 'block';
        }

        function loadContacts() {
            const contactsList = document.getElementById('contactsList');
            const contacts = contactsData[currentBrand] || [];
            
            if (contacts.length === 0) {
                contactsList.innerHTML = '<p>Hen√ºz kontak bilgisi eklenmemi≈ü.</p>';
                return;
            }
            
            contactsList.innerHTML = contacts.map((contact, index) => `
                <div class="contact-card">
                    <h4>${contact.name}</h4>
                    <p><strong>Pozisyon:</strong> ${contact.title}</p>
                    ${contact.email ? `<p><strong>E-posta:</strong> <a href="mailto:${contact.email}">${contact.email}</a></p>` : ''}
                    ${contact.phone ? `<p><strong>Telefon:</strong> <a href="tel:${contact.phone}">${contact.phone}</a></p>` : ''}
                    ${contact.linkedin ? `<p><strong>LinkedIn:</strong> <a href="${contact.linkedin}" target="_blank">Profil</a></p>` : ''}
                    <div class="contact-meta">
                        Eklenme: ${new Date(contact.created).toLocaleDateString('tr-TR')}
                        <button class="btn btn-sm btn-secondary" onclick="deleteContact(${index})" style="float: right;">Sil</button>
                    </div>
                </div>
            `).join('');
        }

        function loadNotes() {
            const notesTextarea = document.getElementById('brandNotes');
            const brandNotes = notesData[currentBrand];
            
            if (brandNotes) {
                // Yeni format (object) veya eski format (string) kontrol et
                if (typeof brandNotes === 'object' && brandNotes.content) {
                    notesTextarea.value = brandNotes.content;
                    
                    // Son g√ºncelleme bilgisini g√∂ster
                    const existingInfo = document.getElementById('noteInfo');
                    if (existingInfo) existingInfo.remove();
                    
                    if (brandNotes.lastModified) {
                        const noteInfo = document.createElement('div');
                        noteInfo.id = 'noteInfo';
                        noteInfo.style.cssText = 'font-size: 0.8rem; color: #6c757d; margin-top: 0.5rem;';
                        noteInfo.textContent = `Son g√ºncelleme: ${new Date(brandNotes.lastModified).toLocaleString('tr-TR')} - ${brandNotes.modifiedBy || 'Bilinmiyor'}`;
                        notesTextarea.parentElement.insertBefore(noteInfo, notesTextarea.nextSibling);
                    }
                } else {
                    notesTextarea.value = brandNotes; // Eski format
                }
            } else {
                notesTextarea.value = '';
            }
        }

        function showAddContactForm() {
            document.getElementById('addContactForm').style.display = 'block';
            document.getElementById('contactName').focus();
        }

        function hideAddContactForm() {
            document.getElementById('addContactForm').style.display = 'none';
            clearContactForm();
        }

        function clearContactForm() {
            document.getElementById('contactName').value = '';
            document.getElementById('contactTitle').value = '';
            document.getElementById('contactEmail').value = '';
            document.getElementById('contactPhone').value = '';
            document.getElementById('contactLinkedin').value = '';
        }

        async function saveContact() {
            const name = document.getElementById('contactName').value.trim();
            const title = document.getElementById('contactTitle').value.trim();
            const email = document.getElementById('contactEmail').value.trim();
            const phone = document.getElementById('contactPhone').value.trim();
            const linkedin = document.getElementById('contactLinkedin').value.trim();
            
            if (!name || !title) {
                alert('ƒ∞sim ve pozisyon alanlarƒ± zorunludur.');
                return;
            }
            
            if (!contactsData[currentBrand]) {
                contactsData[currentBrand] = [];
            }
            
            const newContact = {
                name,
                title,
                email,
                phone,
                linkedin,
                created: new Date().toISOString(),
                createdBy: googleDriveSync.currentUser,
                lastModified: new Date().toISOString()
            };
            
            contactsData[currentBrand].push(newContact);
            
            // Local storage'a kaydet
            localStorage.setItem('brandContacts', JSON.stringify(contactsData));
            
            // Google Drive'a senkronize et
            if (GOOGLE_DRIVE_CONFIG.enabled) {
                googleDriveSync.showSyncStatus('info', 'Kontak bilgisi Google Drive\'a kaydediliyor...');
                await googleDriveSync.saveRemoteContacts(contactsData);
                googleDriveSync.showSyncStatus('success', 'Kontak bilgisi Google Drive\'a kaydedildi!');
            }
            
            loadContacts();
            hideAddContactForm();
            populateTable(); // Refresh table to show contact indicator
            
            showSuccessMessage('Kontak bilgisi ba≈üarƒ±yla kaydedildi!');
        }

        function deleteContact(index) {
            if (confirm('Bu kontak bilgisini silmek istediƒüinizden emin misiniz?')) {
                contactsData[currentBrand].splice(index, 1);
                
                if (contactsData[currentBrand].length === 0) {
                    delete contactsData[currentBrand];
                }
                
                localStorage.setItem('brandContacts', JSON.stringify(contactsData));
                loadContacts();
                populateTable();
                
                showSuccessMessage('Kontak bilgisi silindi.');
            }
        }

        async function saveNotes() {
            const notes = document.getElementById('brandNotes').value.trim();
            
            if (notes) {
                notesData[currentBrand] = {
                    content: notes,
                    lastModified: new Date().toISOString(),
                    modifiedBy: googleDriveSync.currentUser
                };
            } else {
                delete notesData[currentBrand];
            }
            
            // Local storage'a kaydet
            localStorage.setItem('brandNotes', JSON.stringify(notesData));
            
            // Google Drive'a senkronize et
            if (GOOGLE_DRIVE_CONFIG.enabled) {
                googleDriveSync.showSyncStatus('info', 'Notlar Google Drive\'a kaydediliyor...');
                await googleDriveSync.saveRemoteNotes(notesData);
                googleDriveSync.showSyncStatus('success', 'Notlar Google Drive\'a kaydedildi!');
            }
            
            populateTable(); // Refresh table to show note indicator
            
            showSuccessMessage('Notlar kaydedildi!');
        }

        function exportData() {
            const dataToExport = {
                contacts: contactsData,
                notes: notesData,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const dataBlob = new Blob([JSON.stringify(dataToExport, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `luxury-brands-data-${new Date().toISOString().split('T')[0]}.json`;
            a.click();
            
            URL.revokeObjectURL(url);
            
            showSuccessMessage('Veriler ba≈üarƒ±yla dƒ±≈üa aktarƒ±ldƒ±!');
        }

        function importData() {
            const modal = document.getElementById('dataModal');
            const content = document.getElementById('dataModalContent');
            
            content.innerHTML = `
                <div class="file-input">
                    <label for="importFile" class="file-input-label">
                        üìÇ JSON dosyasƒ± se√ßin
                    </label>
                    <input type="file" id="importFile" accept=".json" onchange="handleFileImport(event)">
                </div>
                <div class="alert alert-info">
                    <strong>Dikkat:</strong> ƒ∞√ße aktarƒ±lan veriler mevcut verilerin √ºzerine yazƒ±lacaktƒ±r. 
                    √ñnce mevcut verilerinizi dƒ±≈üa aktararak yedeklemeniz √∂nerilir.
                </div>
            `;
            
            modal.style.display = 'block';
        }

        function handleFileImport(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    if (importedData.contacts) {
                        contactsData = importedData.contacts;
                        localStorage.setItem('brandContacts', JSON.stringify(contactsData));
                    }
                    
                    if (importedData.notes) {
                        notesData = importedData.notes;
                        localStorage.setItem('brandNotes', JSON.stringify(notesData));
                    }
                    
                    populateTable();
                    closeModal('dataModal');
                    showSuccessMessage('Veriler ba≈üarƒ±yla i√ße aktarƒ±ldƒ±!');
                    
                } catch (error) {
                    alert('Dosya formatƒ± ge√ßersiz. L√ºtfen ge√ßerli bir JSON dosyasƒ± se√ßin.');
                }
            };
            
            reader.readAsText(file);
        }

        function clearAllData() {
            if (confirm('T√ºm kontak bilgileri ve notlar silinecektir. Bu i≈ülem geri alƒ±namaz. Devam etmek istediƒüinizden emin misiniz?')) {
                contactsData = {};
                notesData = {};
                localStorage.removeItem('brandContacts');
                localStorage.removeItem('brandNotes');
                populateTable();
                showSuccessMessage('T√ºm veriler temizlendi.');
            }
        }

        function showSuccessMessage(message) {
            const alert = document.createElement('div');
            alert.className = 'alert alert-success';
            alert.textContent = message;
            alert.style.position = 'fixed';
            alert.style.top = '20px';
            alert.style.right = '20px';
            alert.style.zIndex = '2000';
            
            document.body.appendChild(alert);
            
            setTimeout(() => {
                alert.remove();
            }, 3000);
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            if (modalId === 'contactModal') {
                hideAddContactForm();
            }
        }

        async function showBrandDetails(brandName) {
            const modal = document.getElementById('brandDetailModal');
            const body = document.getElementById('brandDetailBody');
            
            try {
                // Brand name'i normalize et (bo≈üluklarƒ± _ ile deƒüi≈ütir)
                const normalizedName = brandName.replace(/\s+/g, '_').replace(/&/g, '_');
                const brandDetail = brandDetailsData[normalizedName] || brandDetailsData[brandName];
                
                if (brandDetail && brandDetail.content) {
                    // JSON verisini HTML'e d√∂n√º≈üt√ºr
                    const htmlContent = convertBrandDetailToHTML(brandDetail);
                    body.innerHTML = htmlContent;
                } else {
                    // Hi√ßbir veri bulunamazsa placeholder g√∂ster
                    body.innerHTML = generatePlaceholderContent(brandName);
                }
            } catch (error) {
                console.log('Brand details load error:', error);
                body.innerHTML = generatePlaceholderContent(brandName);
            }
            
            modal.style.display = 'block';
        }

        function convertBrandDetailToHTML(brandDetail) {
            const content = brandDetail.content;
            
            let html = `<div class="brand-detail-content">
                <h1>${brandDetail.title}</h1>
                
                <div class="section">
                    <h2>üìä √ñzet</h2>
                    <div class="summary-grid">
                        <div><strong>Kategori:</strong> ${content.ozet.kategori}</div>
                        <div><strong>Ana ≈ûirket:</strong> ${content.ozet.anaShirket}</div>
                        <div><strong>EMEA Varlƒ±ƒüƒ±:</strong> ${content.ozet.emeaVarligi}</div>
                        <div><strong>Geni≈üleme Aktivitesi:</strong> ${'‚≠ê'.repeat(content.ozet.genislemeAktivitesi)} ${content.ozet.aciklama}</div>
                    </div>
                </div>
                
                <div class="section">
                    <h2>üè¢ Maƒüaza Geli≈ütirme Stratejisi</h2>
                    <div><strong>Konsept:</strong> ${content.magazaGelistirmeStratejisi.konsept}</div>
                    <div><strong>Ortalama B√ºy√ºkl√ºk:</strong> ${content.magazaGelistirmeStratejisi.ortalamaButukluk}</div>
                    <div><strong>Yatƒ±rƒ±m Tutarƒ±:</strong> ${content.magazaGelistirmeStratejisi.yatirimTutari}</div>
                    
                    <h3>Ana √ñzellikler:</h3>
                    <ul>`;
            
            content.magazaGelistirmeStratejisi.anaOzellikler.forEach(item => {
                html += `<li>${item}</li>`;
            });
            
            html += `</ul>
                    <h3>üî® Construction Fƒ±rsatlarƒ±:</h3>
                    <ul>`;
            
            content.magazaGelistirmeStratejisi.constructionFirsatlari.forEach(item => {
                html += `<li>${item}</li>`;
            });
            
            html += `</ul>
                </div>
                
                <div class="section">
                    <h2>üåç EMEA Geni≈üleme Planlarƒ±</h2>
                    <h3>Aktif Projeler:</h3>
                    <ul>`;
            
            content.emeaGenisleme.aktifProjeler.forEach(project => {
                html += `<li><strong>${project.sehir || project.bolge || project.program || 'Genel'}:</strong> ${project.proje}`;
                if (project.tarih) html += ` (${project.tarih})`;
                if (project.kapsam) html += ` - ${project.kapsam}`;
                html += `</li>`;
            });
            
            html += `</ul>`;
            
            if (content.emeaGenisleme.tamamlananProjeler && content.emeaGenisleme.tamamlananProjeler.length > 0) {
                html += `<h3>Tamamlanan Projeler:</h3><ul>`;
                content.emeaGenisleme.tamamlananProjeler.forEach(project => {
                    html += `<li>${project}</li>`;
                });
                html += `</ul>`;
            }
            
            html += `</div>
                
                <div class="section">
                    <h2>üë• Karar Vericiler</h2>
                    <h3>Maƒüaza Planlama Ekibi:</h3>
                    <ul>`;
            
            content.kararVericiler.magazaPlanlama.forEach(person => {
                html += `<li>`;
                if (person.isim) html += `<strong>${person.isim}</strong> - `;
                if (person.departman) html += `<strong>${person.departman}</strong> - `;
                html += `${person.pozisyon}`;
                if (person.sirket) html += ` (${person.sirket})`;
                if (person.odak) html += ` - ${person.odak}`;
                html += `</li>`;
            });
            
            html += `</ul>
                </div>
                
                <div class="section">
                    <h2>‚≠ê ƒ∞≈ü Potansiyeli Deƒüerlendirmesi</h2>
                    <div class="potential-score"><strong>Puan:</strong> ${content.isPotansiyeli.puan}</div>
                    <h3>Ana Kriterler:</h3>
                    <ul>`;
            
            content.isPotansiyeli.kriterler.forEach(criteria => {
                html += `<li>${criteria}</li>`;
            });
            
            html += `</ul>
                </div>
            </div>`;
            
            return html;
        }

        function generatePlaceholderContent(brandName) {
            return `
                <div class="alert alert-info">
                    <h3>${brandName} - ƒ∞≈ü Geli≈ütirme Analizi</h3>
                    <p><strong>Bu marka i√ßin detaylƒ± analiz raporu mevcut.</strong></p>
                    <div class="placeholder-content">
                        <h4>üìä √ñzet</h4>
                        <p>Bu marka i√ßin comprehensive business development analizi mevcuttur.</p>
                        
                        <h4>üè¢ Maƒüaza Geli≈ütirme Stratejisi</h4>
                        <p>Marka konsepti ve construction fƒ±rsatlarƒ± detaylandƒ±rƒ±lmƒ±≈ütƒ±r.</p>
                        
                        <h4>üåç EMEA Geni≈üleme Planlarƒ±</h4>
                        <p>B√∂lgedeki aktif projeler ve yakla≈üan fƒ±rsatlar listelenmi≈ütir.</p>
                        
                        <h4>üë• Karar Vericiler</h4>
                        <p>Store planning kontaklarƒ± ve ileti≈üim stratejileri belirlenmi≈ütir.</p>
                        
                        <h4>‚≠ê ƒ∞≈ü Potansiyeli</h4>
                        <p>Construction & millwork fƒ±rsatlarƒ± deƒüerlendirilmi≈ütir.</p>
                    </div>
                </div>
            `;
        }

        function setupEventListeners() {
            // Close modals when clicking outside
            window.onclick = function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                    if (event.target.id === 'contactModal') {
                        hideAddContactForm();
                    }
                }
            };
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    const modals = document.querySelectorAll('.modal');
                    modals.forEach(modal => {
                        if (modal.style.display === 'block') {
                            modal.style.display = 'none';
                        }
                    });
                    hideAddContactForm();
                }
            });
        }

        // Initialize the application when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>